angular.module("starter").controller("FolderListController",function($scope,$stateParams,$ionicNavBarDelegate,$timeout,SB,Customer,Folder,Padlock){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,search:{},card_design:!1}),Folder.setValueId($stateParams.value_id),Folder.setCategoryId(_.get($stateParams,"category_id",null)),$scope.computeCollections=function(){var unlocked=Customer.can_access_locked_features||Padlock.unlocked_by_qrcode,compute=function(collection){var destination=[];return angular.forEach(collection,function(folder_item){if(unlocked||!folder_item.is_locked||"padlock"===folder_item.code){if(unlocked&&"padlock"===folder_item.code)return;this.push(folder_item)}},destination),destination};$scope.collection=compute($scope.collection_data),$scope.search_list=compute($scope.search_list_data)},$scope.loadContent=function(){Folder.findAll().then(function(data){var values=angular.copy(data);return $scope.cover=values.cover,$ionicNavBarDelegate.title(values.page_title),$timeout(function(){$scope.page_title=values.page_title}),$scope.collection_data=values.folders,$scope.search_list_data=values.search_list,$scope.computeCollections(),$scope.show_search=values.show_search,values}).then(function(data){$scope.is_loading=!1})},$scope.$on(SB.EVENTS.AUTH.loginSuccess,function(){$scope.loadContent()}),$scope.$on(SB.EVENTS.AUTH.logoutSuccess,function(){$scope.loadContent()}),$scope.$on(SB.EVENTS.PADLOCK.unlockFeatures,function(){$scope.loadContent()}),$scope.$on(SB.EVENTS.PADLOCK.lockFeatures,function(){$scope.loadContent()}),$scope.loadContent()}),angular.module("starter").factory("Folder",function($pwaRequest){var factory={value_id:null,folder_id:null,category_id:null,collection:[],extendedOptions:{},setValueId:function(value_id){factory.value_id=value_id},setCategoryId:function(category_id){factory.category_id=category_id},setExtendedOptions:function(options){factory.extendedOptions=options},findAll:function(value_id,category_id,options){var localValueId=void 0===value_id?this.value_id:value_id,localCategoryId=void 0===category_id?this.category_id:category_id;if(!localValueId)return $pwaRequest.reject("[Factory::Facebook.findAll] missing value_id");var payload=$pwaRequest.getPayloadForValueId(factory.value_id);return!1!==payload&&null===localCategoryId?$pwaRequest.resolve(payload):null!==localCategoryId&&void 0!==_.find(factory.collection,{category_id:localCategoryId})?_.find(factory.collection,{category_id:localCategoryId}):$pwaRequest.get("folder/mobile_list/findallv2",angular.extend({urlParams:{value_id:localValueId,category_id:localCategoryId}},factory.extendedOptions,options))}};return factory});