angular.module("starter").controller("TopicController",function($rootScope,$scope,$stateParams,$timeout,Topic){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,no_items:!1}),Topic.setValueId($stateParams.value_id),$scope.loadContent=function(){Topic.findAll().then(function(data){data.collection&&data.collection.length?$scope.items=data.collection:$scope.no_items=!0,data.description?$scope.description=data.description:$scope.description=null,$scope.page_title=data.page_title,$scope.is_loading=!1})},$scope.toggle=function(item){$rootScope.isNotAvailableOffline()?$timeout(function(){item.is_subscribed=!item.is_subscribed},200):($scope.is_loading=!0,Topic.subscribe(item.id,item.is_subscribed).then(function(){Topic.findAll(),$scope.is_loading=!1}))},$scope.loadContent()}),angular.module("starter").factory("Topic",function($pwaRequest,$session){var factory={value_id:null,extendedOptions:{},setValueId:function(value_id){factory.value_id=value_id},setExtendedOptions:function(options){factory.extendedOptions=options},findAll:function(){return this.value_id?$pwaRequest.get("topic/mobile_list/findall",angular.extend({urlParams:{value_id:this.value_id,device_uid:$session.getDeviceUid()}},factory.extendedOptions)):$pwaRequest.reject("[Factory::Topic.findAll] missing value_id")},subscribe:function(topic_id,is_subscribed){return $pwaRequest.post("topic/mobile_list/subscribe",{data:{category_id:topic_id,device_uid:$session.getDeviceUid(),subscribe:is_subscribed}})}};return factory});