angular.module("starter").controller("WordpressListController",function($filter,$window,$scope,$state,$stateParams,Wordpress){angular.extend($scope,{is_loading:!0,value_id:$stateParams.value_id,cover:{},collection:[],can_load_older_posts:!0,offset:null}),Wordpress.setValueId($stateParams.value_id),$scope.loadContent=function(){var offset=$scope.offset=$scope.collection.length;Wordpress.findAll(offset).then(function(data){if($scope.collection=$scope.collection.concat(data.collection),Wordpress.collection=$scope.collection,data.cover||$scope.cover.id)data.cover&&data.cover.id&&($scope.cover=data.cover);else if($scope.collection.length)for(var i in $scope.collection)if(!$scope.collection[i].is_hidden){$scope.collection[i].picture&&($scope.collection[i].is_hidden=!0,$scope.cover=$scope.collection[i]);break}$scope.collection_chunks=$filter("chunk")($scope.collection,2),$scope.can_load_older_posts=!!data.collection.length,$scope.page_title=data.page_title}).then(function(){$scope.is_loading=!1,$scope.$broadcast("scroll.infiniteScrollComplete")})},$scope.showItem=function(item){$state.go("wordpress-view",{value_id:$scope.value_id,post_id:item.id,offset:$scope.offset})},$scope.loadMore=function(){$scope.loadContent()},$scope.loadContent()}).controller("WordpressViewController",function($scope,$stateParams,$window,Wordpress){angular.extend($scope,{is_loading:!1,value_id:$stateParams.value_id}),$scope.loadContent=function(){$scope.item=_.filter(Wordpress.collection,{id:1*$stateParams.post_id})[0],$scope.page_title=$scope.item.title},Wordpress.setValueId($stateParams.value_id),$scope.loadContent()}),angular.module("starter").factory("Wordpress",function($pwaRequest){var factory={value_id:null,post_id:null,collection:null,extendedOptions:{},setValueId:function(value_id){factory.value_id=value_id},setExtendedOptions:function(options){factory.extendedOptions=options},preFetch:function(page){factory.findAll()},findAll:function(offset){return this.value_id?$pwaRequest.get("wordpress/mobile_list/findall",angular.extend({urlParams:{value_id:this.value_id,offset:offset}},factory.extendedOptions)):$pwaRequest.reject("[Factory::Wordpress.findAll] missing value_id")}};return factory});